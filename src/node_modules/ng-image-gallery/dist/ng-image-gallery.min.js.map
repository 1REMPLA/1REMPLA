{"version":3,"sources":["ng-image-gallery.min.js"],"names":["keys","enter","esc","left","right","angular","module","provider","defOpts","thumbnails","thumbSize","inline","bubbles","bubbleSize","imgBubbles","bgClose","piracy","imgAnim","setOpts","newOpts","extend","$get","directive","$parse","restrict","scope","link","element","attrs","bind","event","preventDefault","attributes","image","Image","src","showImageAsync","onload","$apply","asyncKind","css","backgroundImage","empty","$window","$timeout","pre","autoFitBubbles","scrollerWidth","getBoundingClientRect","width","minMargin","bubbleSpace","rawQuotient","bubblesInView","Math","floor","extraSpace","extraMargin","bubbleMargin","finalBubbleSpace","_bubblesInView","_finalBubbleSpace","_bubbleMargin","_safeApply","noop","$watch","$watchCollection","indexCalc","relativeIndexToBubbleWrapper","_activeImageIndex","outBubbles","images","length","_bubblesContainerMarginLeft","$rootScope","$q","ngImageGalleryOpts","replace","transclude","methods","conf","onOpen","onClose","onDelete","template","elem","attr","_showLoader","imgLoading","_hideLoader","_loadImg","imgObj","reject","deferred","defer","hasOwnProperty","img","url","cached","resolve","promise","_setActiveImg","indexOf","_activeImg","_imgMoveDirection","then","fn","phase","this","$root","$$phase","_deleteImg","_deleteImgCallback","index","console","log","splice","cb","undefined","imagesFirstWatch","activeImageIndexFirstWatch","newImgIndex","open","imgIndex","opened","document","body","addClass","close","removeClass","next","prev","backgroundClose","e","noCloseClasses","i","target","classList","which","window","Hammer","hammerElem","on","ev","removeClassFromDocumentBody","$on"],"mappings":"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","file":"ng-image-gallery.min.js","sourcesContent":[" (function(){\r\n\t'use strict';\r\n\t\r\n\t// Key codes\r\n\tvar keys = {\r\n\t\tenter : 13,\r\n\t\tesc   : 27,\r\n\t\tleft  : 37,\r\n\t\tright : 39\r\n\t};\r\n\r\n\tangular\r\n\t.module('thatisuday.ng-image-gallery', ['ngAnimate'])\r\n\t.provider('ngImageGalleryOpts', function(){\r\n\t\tvar defOpts = {\r\n\t\t\tthumbnails  \t:   true,\r\n\t\t\tthumbSize\t\t: \t80,\r\n\t\t\tinline      \t:   false,\r\n\t\t\tbubbles     \t:   true,\r\n\t\t\tbubbleSize\t\t: \t20,  \r\n\t\t\timgBubbles  \t:   false,\r\n\t\t\tbgClose     \t:   false,\r\n\t\t\tpiracy \t\t\t: \tfalse,\r\n\t\t\timgAnim \t\t: \t'fadeup',\r\n\t\t};\r\n\r\n\t\treturn{\r\n\t\t\tsetOpts : function(newOpts){\r\n\t\t\t\tangular.extend(defOpts, newOpts); \r\n\t\t\t},\r\n\t\t\t$get : function(){\r\n\t\t\t\treturn defOpts;\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\t.directive('ngRightClick', ['$parse', function($parse){\r\n\t    return {\r\n\t    \trestrict: \"A\",\r\n\t\t\tscope : false,\r\n\t\t\tlink : function(scope, element, attrs){\r\n\t\t\t\telement.bind('contextmenu', function(event){\r\n\t\t\t\t\tif(scope.piracy == false){\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\treturn scope.piracy;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t    };\r\n\t}])\r\n\t.directive(\"showImageAsync\", [function(){\r\n\t\treturn {\r\n\t\t\trestrict: \"A\",\r\n\t\t\tscope: false,\r\n\t\t\tlink: function (scope, element, attributes){\r\n\t\t\t\tvar image = new Image();\r\n\t\t\t\timage.src = attributes.showImageAsync;\r\n\t\t\t\timage.onload = function(){\r\n\t\t\t\t\tscope.$apply(function(){\r\n\t\t\t\t\t\tif(attributes.asyncKind == 'thumb'){\r\n\t\t\t\t\t\t\telement.css({ backgroundImage: 'url(\"' + attributes.showImageAsync + '\")' });\r\n\t\t\t\t\t\t\telement.empty(); // remove loading animation element\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(attributes.asyncKind == 'bubble'){\r\n\t\t\t\t\t\t\telement.css({ backgroundImage: 'url(\"' + attributes.showImageAsync + '\")' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t};\r\n\t}])\r\n\t.directive(\"bubbleAutoFit\", ['$window', '$timeout', function($window, $timeout){\r\n\t\treturn {\r\n\t\t\trestrict: \"A\",\r\n\t\t\tscope: false,\r\n\t\t\tlink: {\r\n\t\t\t\tpre : function (scope, element, attributes){\r\n\t\t\t\t\tvar autoFitBubbles = function(){\r\n\t\t\t\t\t\tvar scrollerWidth = element[0].getBoundingClientRect().width;\r\n\t\t\t\t\t\tif(scrollerWidth == 0) return;\r\n\r\n\t\t\t\t\t\tvar bubbleSize = scope.bubbleSize;\r\n\t\t\t\t\t\tvar minMargin = 4 + 4; // left+right\r\n\t\t\t\t\t\tvar bubbleSpace = (bubbleSize + minMargin);\r\n\t\t\t\t\t\tvar rawQuotient = scrollerWidth / bubbleSpace;\r\n\t\t\t\t\t\tvar bubblesInView = Math.floor(rawQuotient);\r\n\t\t\t\t\t\tvar extraSpace = scrollerWidth - (bubblesInView * bubbleSpace);\r\n\t\t\t\t\t\tvar extraMargin = extraSpace / bubblesInView;\r\n\t\t\t\t\t\tvar bubbleMargin = minMargin + extraMargin;\r\n\t\t\t\t\t\tvar finalBubbleSpace = bubbleMargin + bubbleSize;\r\n\r\n\t\t\t\t\t\tscope._bubblesInView = bubblesInView;\r\n\t\t\t\t\t\tscope._finalBubbleSpace = finalBubbleSpace;\r\n\t\t\t\t\t\tscope._bubbleMargin = '0 ' + (bubbleMargin/2) + 'px';\r\n\r\n\t\t\t\t\t\tscope._safeApply(angular.noop);\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t$timeout(autoFitBubbles);\r\n\r\n\t\t\t\t\tangular.element($window).bind('resize', function(){\r\n\t\t\t\t\t\t$timeout(autoFitBubbles);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tscope.$watch('inline', function(){\r\n\t\t\t\t\t\t$timeout(autoFitBubbles);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tscope.$watch('bubbleSize', function(){\r\n\t\t\t\t\t\t$timeout(autoFitBubbles);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tscope.$watchCollection('images', function(){\r\n\t\t\t\t\t\t$timeout(autoFitBubbles);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}])\r\n\t.directive(\"bubbleAutoScroll\", ['$window', '$timeout', function($window, $timeout){\r\n\t\treturn {\r\n\t\t\trestrict: \"A\",\r\n\t\t\tscope: false,\r\n\t\t\tlink: function (scope, element, attributes){\r\n\t\t\t\t\r\n\t\t\t\tvar indexCalc = function(){\r\n\t\t\t\t\tvar relativeIndexToBubbleWrapper = scope._bubblesInView - (scope._bubblesInView - scope._activeImageIndex);\r\n\t\t\t\t\t\r\n\t\t\t\t\t$timeout(function(){\r\n\t\t\t\t\t\tif(relativeIndexToBubbleWrapper > scope._bubblesInView - 2){\r\n\t\t\t\t\t\t\tvar outBubbles = ((scope._activeImageIndex+1) - scope._bubblesInView) + 1;\r\n\r\n\t\t\t\t\t\t\tif(scope._activeImageIndex != (scope.images.length - 1)){\r\n\t\t\t\t\t\t\t\tscope._bubblesContainerMarginLeft = '-' + (scope._finalBubbleSpace * outBubbles) + 'px';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tscope._bubblesContainerMarginLeft = '-' + (scope._finalBubbleSpace * (outBubbles - 1)) + 'px';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tscope._bubblesContainerMarginLeft = '0px';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tangular.element($window).bind('resize', function(){\r\n\t\t\t\t\t$timeout(indexCalc);\r\n\t\t\t\t});\r\n\t\t\t\tscope.$watch('_bubblesInView', function(){\r\n\t\t\t\t\t$timeout(indexCalc);\r\n\t\t\t\t});\r\n\t\t\t\tscope.$watch('_activeImageIndex', function(){\r\n\t\t\t\t\t$timeout(indexCalc);\r\n\t\t\t\t});\r\n\t\t\t\tscope.$watchCollection('images', function(){\r\n\t\t\t\t\t$timeout(indexCalc);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t}])\r\n\t.directive('ngImageGallery', ['$rootScope', '$timeout', '$q', 'ngImageGalleryOpts',\r\n\tfunction($rootScope, $timeout, $q, ngImageGalleryOpts){\r\n\t\treturn {\r\n\t\t\treplace : true,\r\n\t\t\ttransclude : false,\r\n\t\t\trestrict : 'AE',\r\n\t\t\tscope : {\r\n\t\t\t\timages \t\t\t: \t'=',\t\t// []\r\n\t\t\t\tmethods \t\t: \t'=?',\t\t// {}\r\n\t\t\t\tconf \t\t\t: \t'=?',\t\t// {}\r\n\r\n\t\t\t\tthumbnails \t\t: \t'=?',\t\t// true|false\r\n\t\t\t\tthumbSize\t\t: \t'=?', \t\t// px\r\n\t\t\t\tinline \t\t\t: \t'=?',\t\t// true|false\r\n\t\t\t\tbubbles \t\t: \t'=?',\t\t// true|false\r\n\t\t\t\tbubbleSize \t\t: \t'=?',\t\t// px\r\n\t\t\t\timgBubbles \t\t: \t'=?',\t\t// true|false\r\n\t\t\t\tbgClose \t\t: \t'=?',\t\t// true|false\r\n\t\t\t\tpiracy\t\t\t: \t'=?',\t\t// true|false\r\n\t\t\t\timgAnim \t\t: \t'@?',\t\t// {name}\r\n\r\n\t\t\t\tonOpen \t\t\t: \t'&?',\t\t// function\r\n\t\t\t\tonClose \t\t: \t'&?',\t\t// function,\r\n\t\t\t\tonDelete\t\t: \t'&?'\r\n\t\t\t},\r\n\t\t\ttemplate : \t'<div class=\"ng-image-gallery img-move-dir-{{_imgMoveDirection}}\" ng-class=\"{inline:inline}\" ng-hide=\"images.length == 0\">'+\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// Thumbnails container\r\n\t\t\t\t\t\t\t//  Hide for inline gallery\r\n\t\t\t\t\t\t\t'<div ng-if=\"thumbnails && !inline\" class=\"ng-image-gallery-thumbnails\">' +\r\n \t\t\t\t\t\t\t\t'<div class=\"thumb\" ng-repeat=\"image in images track by image.url\" ng-click=\"methods.open($index);\" show-image-async=\"{{image.thumbUrl || image.url}}\" async-kind=\"thumb\" ng-style=\"{\\'width\\' : thumbSize+\\'px\\', \\'height\\' : thumbSize+\\'px\\'}\">'+\r\n \t\t\t\t\t\t\t\t\t'<div class=\"loader\"></div>'+\r\n \t\t\t\t\t\t\t\t'</div>' +\r\n \t\t\t\t\t\t\t'</div>' +\r\n\r\n\t\t\t\t\t\t\t// Modal container\r\n\t\t\t\t\t\t\t// (inline container for inline modal)\r\n\t\t\t\t\t\t\t'<div class=\"ng-image-gallery-modal\" ng-if=\"opened\" ng-cloak>' +\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// Gallery backdrop container\r\n\t\t\t\t\t\t\t\t// (hide for inline gallery)\r\n\t\t\t\t\t\t\t\t'<div class=\"ng-image-gallery-backdrop\" ng-if=\"!inline\"></div>'+\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// Gallery contents container\r\n\t\t\t\t\t\t\t\t// (hide when image is loading)\r\n\t\t\t\t\t\t\t\t'<div class=\"ng-image-gallery-content\" ng-show=\"!imgLoading\" ng-click=\"backgroundClose($event);\">'+\r\n\r\n\t\t\t\t\t\t\t\t\t// actions icons container\r\n\t\t\t\t\t\t\t\t\t'<div class=\"actions-icons-container\">'+\r\n\t\t\t\t\t\t\t\t\t\t// Delete image icon\r\n\t\t\t\t\t\t\t\t\t\t'<div class=\"delete-img\" ng-repeat=\"image in images track by image.id\" ng-if=\"_activeImg == image && image.deletable\" title=\"Delete this image...\" ng-click=\"_deleteImg(image)\"></div>'+\r\n\t\t\t\t\t\t\t\t\t'</div>'+\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t// control icons container\r\n\t\t\t\t\t\t\t\t\t'<div class=\"control-icons-container\">'+\r\n\t\t\t\t\t\t\t\t\t\t// External link icon\r\n\t\t\t\t\t\t\t\t\t\t'<a class=\"ext-url\" ng-repeat=\"image in images track by image.id\" ng-if=\"_activeImg == image && image.extUrl\" href=\"{{image.extUrl}}\" target=\"_blank\" title=\"Open image in new tab...\"></a>'+\r\n\r\n\t\t\t\t\t\t\t\t\t\t// Close Icon (hidden in inline gallery)\r\n\t\t\t\t\t\t\t\t\t\t'<div class=\"close\" ng-click=\"methods.close();\" ng-if=\"!inline\"></div>'+\r\n\t\t\t\t\t\t\t\t\t'</div>'+\r\n\r\n\t\t\t\t\t\t\t\t\t// Prev-Next Icons\r\n\t\t\t\t\t\t\t\t\t// Add `bubbles-on` class when bubbles are enabled (for offset)\r\n\t\t\t\t\t\t\t\t\t'<div class=\"prev\" ng-click=\"methods.prev();\" ng-class=\"{\\'bubbles-on\\':bubbles}\" ng-hide=\"images.length == 1\"></div>'+\r\n\t\t\t\t\t\t\t\t\t'<div class=\"next\" ng-click=\"methods.next();\" ng-class=\"{\\'bubbles-on\\':bubbles}\" ng-hide=\"images.length == 1\"></div>'+\r\n\r\n\t\t\t\t\t\t\t\t\t// Galleria container\r\n\t\t\t\t\t\t\t\t\t'<div class=\"galleria\">'+\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t// Images container\r\n\t\t\t\t\t\t\t\t\t\t'<div class=\"galleria-images img-anim-{{imgAnim}} img-move-dir-{{_imgMoveDirection}}\">'+\r\n\t\t\t\t\t\t\t\t\t\t\t'<img class=\"galleria-image\" ng-right-click ng-repeat=\"image in images track by image.id\" ng-if=\"_activeImg == image\" ng-src=\"{{image.url}}\" ondragstart=\"return false;\" ng-attr-alt=\"{{image.alt || undefined}}\"/>'+\r\n\t\t\t\t\t\t\t\t\t\t'</div>'+\r\n\r\n\t\t\t\t\t\t\t\t\t\t// Image description container\r\n\t\t\t\t\t\t\t\t\t\t'<div class=\"galleria-title-description-wrapper\">'+\r\n\t\t\t\t\t\t\t\t\t\t\t'<div ng-repeat=\"image in images track by image.id\" ng-if=\"(image.title || image.desc) && (_activeImg == image)\">'+\r\n\t\t\t\t\t\t\t\t\t\t\t\t'<div class=\"title\" ng-if=\"image.title\">{{image.title}}</div>'+\r\n\t\t\t\t\t\t\t\t\t\t\t\t'<div class=\"desc\" ng-if=\"image.desc\">{{image.desc}}</div>'+\r\n\t\t\t\t\t\t\t\t\t\t\t'</div>'+\r\n\t\t\t\t\t\t\t\t\t\t'</div>'+\r\n\r\n\t\t\t\t\t\t\t\t\t\t// Bubble navigation container\r\n\t\t\t\t\t\t\t\t\t\t'<div class=\"galleria-bubbles-wrapper\" ng-if=\"bubbles && !imgBubbles\" ng-hide=\"images.length == 1\" ng-style=\"{\\'height\\' : bubbleSize+\\'px\\'}\" bubble-auto-fit>'+\r\n\t\t\t\t\t\t\t\t\t\t\t'<div class=\"galleria-bubbles\" bubble-auto-scroll ng-style=\"{\\'margin-left\\': _bubblesContainerMarginLeft}\">'+\r\n\t\t\t\t\t\t\t\t\t\t\t\t'<span class=\"galleria-bubble\" ng-click=\"_setActiveImg(image);\" ng-repeat=\"image in images track by image.id\" ng-class=\"{active : (_activeImg == image)}\" ng-style=\"{\\'width\\' : bubbleSize+\\'px\\', \\'height\\' : bubbleSize+\\'px\\', margin: _bubbleMargin}\"></span>'+\r\n\t\t\t\t\t\t\t\t\t\t\t'</div>'+\r\n\t\t\t\t\t\t\t\t\t\t'</div>'+\r\n\r\n\t\t\t\t\t\t\t\t\t\t// Image bubble navigation container\r\n\t\t\t\t\t\t\t\t\t\t'<div class=\"galleria-bubbles-wrapper\" ng-if=\"bubbles && imgBubbles\" ng-hide=\"images.length == 1\" ng-style=\"{\\'height\\' : bubbleSize+\\'px\\'}\" bubble-auto-fit>'+\r\n\t\t\t\t\t\t\t\t\t\t\t'<div class=\"galleria-bubbles\" bubble-auto-scroll ng-style=\"{\\'margin-left\\': _bubblesContainerMarginLeft}\">'+\r\n\t\t\t\t\t\t\t\t\t\t\t\t'<span class=\"galleria-bubble img-bubble\" ng-click=\"_setActiveImg(image);\" ng-repeat=\"image in images track by image.id\" ng-class=\"{active : (_activeImg == image)}\" show-image-async=\"{{image.bubbleUrl || image.thumbUrl || image.url}}\" async-kind=\"bubble\" ng-style=\"{\\'width\\' : bubbleSize+\\'px\\', \\'height\\' : bubbleSize+\\'px\\', \\'border-width\\' : bubbleSize/10+\\'px\\', margin: _bubbleMargin}\"></span>'+\r\n\t\t\t\t\t\t\t\t\t\t\t'</div>'+\r\n\t\t\t\t\t\t\t\t\t\t'</div>'+\r\n\r\n\t\t\t\t\t\t\t\t\t'</div>'+\r\n\r\n\t\t\t\t\t\t\t\t'</div>'+\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// Loading animation overlay container\r\n\t\t\t\t\t\t\t\t// (show when image is loading)\r\n\t\t\t\t\t\t\t\t'<div class=\"ng-image-gallery-loader\" ng-show=\"imgLoading\">'+\r\n\t\t\t\t\t\t\t\t\t'<div class=\"spinner\">'+\r\n\t\t\t\t\t\t\t\t\t\t'<div class=\"rect1\"></div>'+\r\n\t\t\t\t\t\t\t\t\t\t'<div class=\"rect2\"></div>'+\r\n\t\t\t\t\t\t\t\t\t\t'<div class=\"rect3\"></div>'+\r\n\t\t\t\t\t\t\t\t\t\t'<div class=\"rect4\"></div>'+\r\n\t\t\t\t\t\t\t\t\t\t'<div class=\"rect5\"></div>'+\r\n\t\t\t\t\t\t\t\t\t'</div>'+\r\n\t\t\t\t\t\t\t\t'</div>'+\r\n\t\t\t\t\t\t\t'</div>'+\r\n\t\t\t\t\t\t'</div>',\r\n\t\t\t\t\t\t\r\n\t\t\tlink : {\r\n\t\t\t\tpre : function(scope, elem, attr){\r\n\t\t\t\t\t\r\n\t\t\t\t\t/*\r\n\t\t\t\t\t *\tOperational functions\r\n\t\t\t\t\t**/\r\n\r\n\t\t\t\t\t// Show gallery loader\r\n\t\t\t\t\tscope._showLoader = function(){\r\n\t\t\t\t\t\tscope.imgLoading = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Hide gallery loader\r\n\t\t\t\t\tscope._hideLoader = function(){\r\n\t\t\t\t\t\tscope.imgLoading = false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Image load complete promise\r\n\t\t\t\t\tscope._loadImg = function(imgObj){\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// Return rejected promise\r\n\t\t\t\t\t\t// if not image object received\r\n\t\t\t\t\t\tif(!imgObj) return $q.reject();\r\n\r\n\t\t\t\t\t\tvar deferred =  $q.defer();\r\n\r\n\t\t\t\t\t\t// Show loder\r\n\t\t\t\t\t\tif(!imgObj.hasOwnProperty('cached')) scope._showLoader();\r\n\r\n\t\t\t\t\t\t// Process image\r\n\t\t\t\t\t\tvar img = new Image();\r\n\t\t\t\t\t\timg.src = imgObj.url;\r\n\t\t\t\t\t\timg.onload = function(){\r\n\t\t\t\t\t\t\t// Hide loder\r\n\t\t\t\t\t\t\tif(!imgObj.hasOwnProperty('cached')) scope._hideLoader();\r\n\r\n\t\t\t\t\t\t\t// Cache image\r\n\t\t\t\t\t\t\tif(!imgObj.hasOwnProperty('cached')) imgObj.cached = true;\r\n\r\n\t\t\t\t\t\t\treturn deferred.resolve(imgObj);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn deferred.promise;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tscope._setActiveImg = function(imgObj){\r\n\t\t\t\t\t\t// Get images move direction\r\n\t\t\t\t\t\tif(\r\n\t\t\t\t\t\t\tscope.images.indexOf(scope._activeImg) - scope.images.indexOf(imgObj) == (scope.images.length - 1) ||\r\n\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\tscope.images.indexOf(scope._activeImg) - scope.images.indexOf(imgObj) <= 0 && \r\n\t\t\t\t\t\t\t\tscope.images.indexOf(scope._activeImg) - scope.images.indexOf(imgObj) != -(scope.images.length - 1)\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t){\r\n\t\t\t\t\t\t\tscope._imgMoveDirection = 'forward';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tscope._imgMoveDirection = 'backward';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Load image\r\n\t\t\t\t\t\tscope._loadImg(imgObj).then(function(imgObj){\r\n\t\t\t\t\t\t\tscope._activeImg = imgObj;\r\n\t\t\t\t\t\t\tscope._activeImageIndex = scope.images.indexOf(imgObj);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tscope._safeApply = function(fn){\r\n\t\t\t\t\t\tvar phase = this.$root.$$phase;\r\n\t\t\t\t\t\tif(phase == '$apply' || phase == '$digest'){\r\n\t\t\t\t\t\t\tif(fn && (typeof(fn) === 'function')){\r\n\t\t\t\t\t\t\t\tfn();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthis.$apply(fn);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tscope._deleteImg = function(img){\r\n\t\t\t\t\t\tvar _deleteImgCallback = function(){\r\n\t\t\t\t\t\t\tvar index = scope.images.indexOf(img);\r\n\t\t\t\t\t\t\tconsole.log(index);\r\n\t\t\t\t\t\t\tscope.images.splice(index, 1);\r\n\t\t\t\t\t\t\tscope._activeImageIndex = 0;\r\n\r\n\t\t\t\t\t\t\t/**/\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tscope.onDelete({img: img, cb: _deleteImgCallback});\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t/***************************************************/\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t\t/*\r\n\t\t\t\t\t *\tGallery settings\r\n\t\t\t\t\t**/\r\n\r\n\t\t\t\t\t// Modify scope models\r\n\t\t\t\t\tscope.images \t \t = \t(scope.images \t\t!= undefined) ? scope.images \t : \t[];\r\n\t\t\t\t\tscope.methods \t \t = \t(scope.methods \t\t!= undefined) ? scope.methods \t : \t{};\r\n\t\t\t\t\tscope.conf \t \t\t = \t(scope.conf \t\t!= undefined) ? scope.conf \t\t : \t{};\r\n\r\n\t\t\t\t\t// setting options\r\n\t\t\t\t\tscope.$watchCollection('conf', function(conf){\r\n\t\t\t\t\t\tscope.thumbnails \t = \t(conf.thumbnails \t!= undefined) ? conf.thumbnails \t: \t(scope.thumbnails \t!= undefined) \t?  scope.thumbnails\t\t: \tngImageGalleryOpts.thumbnails;\r\n\t\t\t\t\t\tscope.thumbSize \t = \t(conf.thumbSize \t!= undefined) ? conf.thumbSize \t\t: \t(scope.thumbSize \t!= undefined) \t?  scope.thumbSize\t\t: \tngImageGalleryOpts.thumbSize;\r\n\t\t\t\t\t\tscope.inline \t \t = \t(conf.inline \t\t!= undefined) ? conf.inline \t \t: \t(scope.inline \t\t!= undefined) \t?  scope.inline\t\t\t: \tngImageGalleryOpts.inline;\r\n\t\t\t\t\t\tscope.bubbles \t \t = \t(conf.bubbles \t\t!= undefined) ? conf.bubbles \t \t: \t(scope.bubbles \t\t!= undefined) \t?  scope.bubbles\t\t: \tngImageGalleryOpts.bubbles;\r\n\t\t\t\t\t\tscope.bubbleSize \t = \t(conf.bubbleSize \t!= undefined) ? conf.bubbleSize \t : \t(scope.bubbleSize \t!= undefined) \t?  scope.bubbleSize\t\t: \tngImageGalleryOpts.bubbleSize;\r\n\t\t\t\t\t\tscope.imgBubbles \t = \t(conf.imgBubbles \t!= undefined) ? conf.imgBubbles \t: \t(scope.imgBubbles \t!= undefined) \t?  scope.imgBubbles\t\t: \tngImageGalleryOpts.imgBubbles;\r\n\t\t\t\t\t\tscope.bgClose \t \t = \t(conf.bgClose \t\t!= undefined) ? conf.bgClose \t \t: \t(scope.bgClose \t\t!= undefined) \t?  scope.bgClose\t\t: \tngImageGalleryOpts.bgClose;\r\n\t\t\t\t\t\tscope.piracy \t \t = \t(conf.piracy \t\t!= undefined) ? conf.piracy \t \t: \t(scope.piracy \t\t!= undefined) \t?  scope.piracy\t\t\t: \tngImageGalleryOpts.piracy;\r\n\t\t\t\t\t\tscope.imgAnim \t \t = \t(conf.imgAnim \t\t!= undefined) ? conf.imgAnim \t \t: \t(scope.imgAnim \t\t!= undefined) \t?  scope.imgAnim\t\t: \tngImageGalleryOpts.imgAnim;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tscope.onOpen \t = \t(scope.onOpen \t!= undefined) ? scope.onOpen \t : \tangular.noop;\r\n\t\t\t\t\tscope.onClose \t = \t(scope.onClose \t!= undefined) ? scope.onClose \t : \tangular.noop;\r\n\t\t\t\t\tscope.onDelete \t = \t(scope.onDelete != undefined) ? scope.onDelete \t : \tangular.noop;\r\n\t\t\t\t\t\r\n\t\t\t\t\t// If images populate dynamically, reset gallery\r\n\t\t\t\t\tvar imagesFirstWatch = true;\r\n\t\t\t\t\tscope.$watchCollection('images', function(){\r\n\t\t\t\t\t\tif(imagesFirstWatch){\r\n\t\t\t\t\t\t\timagesFirstWatch = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(scope.images.length){\r\n\t\t\t\t\t\t\tscope._setActiveImg(scope.images[scope._activeImageIndex || 0]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// Watch index of visible/active image\r\n\t\t\t\t\t// If index changes, make sure to load/change image\r\n\t\t\t\t\tvar activeImageIndexFirstWatch = true;\r\n\t\t\t\t\tscope.$watch('_activeImageIndex', function(newImgIndex){\r\n\t\t\t\t\t\tif(activeImageIndexFirstWatch){\r\n\t\t\t\t\t\t\tactiveImageIndexFirstWatch = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(scope.images.length){\r\n\t\t\t\t\t\t\tscope._setActiveImg(\r\n\t\t\t\t\t\t\t\tscope.images[newImgIndex]\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// Open modal automatically if inline\r\n\t\t\t\t\tscope.$watch('inline', function(){\r\n\t\t\t\t\t\t$timeout(function(){\r\n\t\t\t\t\t\t\tif(scope.inline) scope.methods.open();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t\t/***************************************************/\r\n\r\n\r\n\t\t\t\t\t/*\r\n\t\t\t\t\t *\tMethods\r\n\t\t\t\t\t**/\r\n\r\n\t\t\t\t\t// Open gallery modal\r\n\t\t\t\t\tscope.methods.open = function(imgIndex){\r\n\t\t\t\t\t\t// Open modal from an index if one passed\r\n\t\t\t\t\t\tscope._activeImageIndex = (imgIndex) ? imgIndex : 0;\r\n\r\n\t\t\t\t\t\tscope.opened = true;\r\n\r\n\t\t\t\t\t\t// set overflow hidden to body\r\n\t\t\t\t\t\tif(!scope.inline) angular.element(document.body).addClass('body-overflow-hidden');\r\n\r\n\t\t\t\t\t\t// call open event after transition\r\n\t\t\t\t\t\t$timeout(function(){\r\n\t\t\t\t\t\t\tscope.onOpen();\r\n\t\t\t\t\t\t}, 300);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Close gallery modal\r\n\t\t\t\t\tscope.methods.close = function(){\r\n\t\t\t\t\t\tscope.opened = false; // Model closed\r\n\r\n\t\t\t\t\t\t// set overflow hidden to body\r\n\t\t\t\t\t\tangular.element(document.body).removeClass('body-overflow-hidden');\r\n\r\n\t\t\t\t\t\t// call close event after transition\r\n\t\t\t\t\t\t$timeout(function(){\r\n\t\t\t\t\t\t\tscope.onClose();\r\n\t\t\t\t\t\t\tscope._activeImageIndex = 0; // Reset index\r\n\t\t\t\t\t\t}, 300);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Change image to next\r\n\t\t\t\t\tscope.methods.next = function(){\r\n\t\t\t\t\t\tif(scope._activeImageIndex == (scope.images.length - 1)){\r\n\t\t\t\t\t\t\tscope._activeImageIndex = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tscope._activeImageIndex = scope._activeImageIndex + 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Change image to prev\r\n\t\t\t\t\tscope.methods.prev = function(){\r\n\t\t\t\t\t\tif(scope._activeImageIndex == 0){\r\n\t\t\t\t\t\t\tscope._activeImageIndex = scope.images.length - 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\tscope._activeImageIndex--;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Close gallery on background click\r\n\t\t\t\t\tscope.backgroundClose = function(e){\r\n\t\t\t\t\t\tif(!scope.bgClose || scope.inline) return;\r\n\r\n\t\t\t\t\t\tvar noCloseClasses = [\r\n\t\t\t\t\t\t\t'galleria-image',\r\n\t\t\t\t\t\t\t'destroy-icons-container',\r\n\t\t\t\t\t\t\t'ext-url',\r\n\t\t\t\t\t\t\t'close',\r\n\t\t\t\t\t\t\t'next',\r\n\t\t\t\t\t\t\t'prev',\r\n\t\t\t\t\t\t\t'galleria-bubble'\r\n\t\t\t\t\t\t];\r\n\r\n\t\t\t\t\t\t// check if clicked element has a class that\r\n\t\t\t\t\t\t// belongs to `noCloseClasses`\r\n\t\t\t\t\t\tfor(var i = 0; i < e.target.classList.length; i++){\r\n\t\t\t\t\t\t\tif(noCloseClasses.indexOf(e.target.classList[i]) != -1){\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tscope.methods.close();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t/***************************************************/\r\n\r\n\r\n\t\t\t\t\t/*\r\n\t\t\t\t\t *\tUser interactions\r\n\t\t\t\t\t**/\r\n\r\n\t\t\t\t\t// Key events\r\n\t\t\t\t\tangular.element(document).bind('keyup', function(event){\r\n\t\t\t\t\t\t// If inline modal, do not interact\r\n\t\t\t\t\t\tif(scope.inline) return;\r\n\r\n\t\t\t\t\t\tif(event.which == keys.right || event.which == keys.enter){\r\n\t\t\t\t\t\t\t$timeout(function(){\r\n\t\t\t\t\t\t\t\tscope.methods.next();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(event.which == keys.left){\r\n\t\t\t\t\t\t\t$timeout(function(){\r\n\t\t\t\t\t\t\t\tscope.methods.prev();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if(event.which == keys.esc){\r\n\t\t\t\t\t\t\t$timeout(function(){\r\n\t\t\t\t\t\t\t\tscope.methods.close();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// Swipe events\r\n\t\t\t\t\tif(window.Hammer){\r\n\t\t\t\t\t\tvar hammerElem = new Hammer(elem[0]);\r\n\t\t\t\t\t\thammerElem.on('swiperight', function(ev){\r\n\t\t\t\t\t\t\t$timeout(function(){\r\n\t\t\t\t\t\t\t\tscope.methods.prev();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\thammerElem.on('swipeleft', function(ev){\r\n\t\t\t\t\t\t\t$timeout(function(){\r\n\t\t\t\t\t\t\t\tscope.methods.next();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\thammerElem.on('doubletap', function(ev){\r\n\t\t\t\t\t\t\tif(scope.inline) return;\r\n\r\n\t\t\t\t\t\t\t$timeout(function(){\r\n\t\t\t\t\t\t\t\tscope.methods.close();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t};\r\n\r\n\r\n\t\t\t\t\t/***********************************************************/\r\n\r\n\r\n\t\t\t\t\t/*\r\n\t\t\t\t\t *\tActions on angular events\r\n\t\t\t\t\t**/\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar removeClassFromDocumentBody = function(){\r\n\t\t\t\t\t\tangular.element(document.body).removeClass('body-overflow-hidden');\r\n\t\t\t\t\t};\r\n\t\t\t\t\t\r\n\t\t\t\t\t$rootScope.$on('$stateChangeSuccess', removeClassFromDocumentBody);\r\n\t\t\t\t\t$rootScope.$on('$routeChangeSuccess', removeClassFromDocumentBody);\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}]);\r\n })();"]}